= simple_form_for [company_or_project, @invoice] do |f|
  = f.error_messages
  .row
    .span3
      %h3 Details
      -if @company
        =link_to 'New customer', new_company_customer_path(@company), target: '_blank'
      = f.input :customer_id, collection: Customer.all, input_html: {class: 'czn-select'}
      = f.input :amount
      = f.input :xero_reference
      = f.input :date, as: :string, input_html: {class: 'datepicker'}
      = f.input :due, as: :string, input_html: {class: 'datepicker'}

    .span5
      %h3.bottom_margin Pending Allocations
      #pending_allocations.sub_form{data:{default_commission: company_or_project.default_commission}}
        =f.simple_fields_for :pending_allocations do |pf|
          =render 'pending_allocation_fields', f: pf
        .links
          =link_to_add_association 'Add allocation', f, :pending_allocations, :class => :btn


      %h3.bottom_margin Payments
      #payments
        =f.simple_fields_for :payments do |pf|
          =render 'payment_fields', f: pf
        .links
          =link_to_add_association 'Add Payment', f, :payments, :class => :btn
  .h-rule
  .row
    .span10
      = f.submit 'Save', class: 'btn btn-primary'

