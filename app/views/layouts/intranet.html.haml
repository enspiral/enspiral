!!! 5

%html
  %head
    %meta{:charset => "utf-8"}
    %title= yield(:title).blank? ? "Enspiral" : "Enspiral - #{yield(:title)}"

    /[if lt IE 9]
      = javascript_include_tag "http://html5shim.googlecode.com/svn/trunk/html5.js"

    = stylesheet_link_tag "less"
    
    /Adding "maximum-scale=1" fixes the Mobile Safari auto-zoom bug: http://filamentgroup.com/examples/iosScaleBug/
    %meta{:name => "viewport", :content => "width=device-width, initial-scale=1"}

    = csrf_meta_tag
    = yield(:head)
  
  %body{:lang => "en"}
    #flasher
      - flash.each do |name, msg|
        = content_tag :div, msg, :id => "flash-#{name}"
        
    #box-shaddow
      #header
        #user-controls
          %div
            - if user_signed_in?
              = link_to 'Dashboard', (current_user.staff? ? staff_dashboard_path : admin_dashboard_path)
              \|
              = link_to 'People', people_path
              \|
              = link_to 'Your Details', edit_person_path(current_person)
              \|
              = link_to "Logout", destroy_user_session_path
      
      = content_tag :h1, yield(:title) if show_title?

      #main
        #content
          = yield
        #sidebar
          = yield(:right)
          = render :partial => '/layouts/side_nav'

      #footer
        Copyright Â©2011 Enspiral Ltd.

  = render "/layouts/partials/javascript"
